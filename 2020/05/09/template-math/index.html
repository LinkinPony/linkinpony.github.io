<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"linkinpony.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.7.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>
<meta name="description" content="212370440130137957 (↑这是一个很大的质数) 19260817 (↑这是一颗很大的子弹) 判断同余时用\((a - b) \mod m&#x3D;&#x3D; 0\) cout不使用科学计数法输出，设置精度: 12cout.setf(ios::fixed,ios::floatfield);cout.precision(2);        # 杂项   ## 大整数">
<meta property="og:type" content="article">
<meta property="og:title" content="[模板]数学">
<meta property="og:url" content="http://linkinpony.github.io/2020/05/09/template-math/index.html">
<meta property="og:site_name" content="I always love dashie">
<meta property="og:description" content="212370440130137957 (↑这是一个很大的质数) 19260817 (↑这是一颗很大的子弹) 判断同余时用\((a - b) \mod m&#x3D;&#x3D; 0\) cout不使用科学计数法输出，设置精度: 12cout.setf(ios::fixed,ios::floatfield);cout.precision(2);        # 杂项   ## 大整数">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-05-08T17:09:32.709Z">
<meta property="article:modified_time" content="2021-08-21T23:35:47.064Z">
<meta property="article:author" content="LinkinPony">
<meta property="article:tag" content="模板">
<meta property="article:tag" content="math">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://linkinpony.github.io/2020/05/09/template-math/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://linkinpony.github.io/2020/05/09/template-math/","path":"2020/05/09/template-math/","title":"[模板]数学"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>[模板]数学 | I always love dashie</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">I always love dashie</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%BF%E6%80%A7%E5%9F%BA"><span class="nav-number">1.</span> <span class="nav-text">线性基</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%9C%E6%95%99bm%E5%BF%AB%E9%80%9F%E6%B1%82%E6%A8%A1%E6%84%8F%E4%B9%89%E4%B8%8B%E7%BA%BF%E6%80%A7%E9%80%92%E6%8E%A8%E5%BC%8F"><span class="nav-number">2.</span> <span class="nav-text">杜教BM(快速求模意义下线性递推式)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8D%9A%E5%BC%88%E8%AE%BA"><span class="nav-number"></span> <span class="nav-text">博弈论</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A8%81%E4%BD%90%E5%A4%AB%E6%B8%B8%E6%88%8F"><span class="nav-number">1.</span> <span class="nav-text">威佐夫游戏</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5"><span class="nav-number"></span> <span class="nav-text">矩阵</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E5%BF%AB%E9%80%9F%E5%B9%82"><span class="nav-number">1.</span> <span class="nav-text">定义&amp;快速幂</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BD%AE%E6%8D%A2%E7%9F%A9%E9%98%B5"><span class="nav-number">2.</span> <span class="nav-text">置换矩阵</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E4%BE%8B%E9%A2%98"><span class="nav-number">3.</span> <span class="nav-text">一些例题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A0%E9%80%9F%E9%80%92%E6%8E%A8%E5%BC%8F"><span class="nav-number">3.1.</span> <span class="nav-text">加速递推式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B1%82%E5%8C%85%E5%90%AB%E4%B8%A5%E6%A0%BCk%E6%9D%A1%E8%BE%B9%E7%9A%84%E6%96%B9%E6%A1%88%E6%95%B0%E6%9C%80%E7%9F%AD%E8%B7%AF"><span class="nav-number">3.2.</span> <span class="nav-text">求包含严格k条边的方案数&#x2F;最短路</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%86%E6%95%B0%E8%A7%84%E5%88%92"><span class="nav-number"></span> <span class="nav-text">0-1分数规划</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E5%88%86%E6%B3%95"><span class="nav-number">1.</span> <span class="nav-text">二分法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dinkelbach-%E7%AE%97%E6%B3%95%E8%BF%AD%E4%BB%A3%E6%B3%95"><span class="nav-number">2.</span> <span class="nav-text">Dinkelbach 算法(迭代法)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98"><span class="nav-number">3.</span> <span class="nav-text">例题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#poj2728desert-king"><span class="nav-number">3.1.</span> <span class="nav-text">[POJ2728]Desert King</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E5%88%86%E6%B3%95-1"><span class="nav-number">3.1.1.</span> <span class="nav-text">二分法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%AD%E4%BB%A3%E6%B3%95"><span class="nav-number">3.1.2.</span> <span class="nav-text">迭代法</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F"><span class="nav-number"></span> <span class="nav-text">多项式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#fft"><span class="nav-number">1.</span> <span class="nav-text">FFT</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%B7%E7%A7%AF"><span class="nav-number">1.1.</span> <span class="nav-text">卷积</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ntt"><span class="nav-number">2.</span> <span class="nav-text">NTT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B1%82%E9%80%86"><span class="nav-number">3.</span> <span class="nav-text">求逆</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B1%82%E5%AF%BC-%E7%A7%AF%E5%88%86"><span class="nav-number">4.</span> <span class="nav-text">求导, 积分</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%96%E5%AF%B9%E6%95%B0"><span class="nav-number">5.</span> <span class="nav-text">取对数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%87%E6%95%B0%E5%87%BD%E6%95%B0"><span class="nav-number">6.</span> <span class="nav-text">指数函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F%E5%B9%82"><span class="nav-number">7.</span> <span class="nav-text">快速幂</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E9%98%B6%E5%B7%AE%E5%88%86%E5%89%8D%E7%BC%80%E5%92%8C"><span class="nav-number">8.</span> <span class="nav-text">高阶差分&#x2F;前缀和</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6"><span class="nav-number"></span> <span class="nav-text">组合数学</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%82%E4%B9%B1%E7%9A%84%E7%BB%93%E8%AE%BA"><span class="nav-number">1.</span> <span class="nav-text">杂乱的结论</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%95%BF%E5%BA%A6%E4%B8%BAn-%E5%8F%AF%E9%80%891m%E7%9A%84%E6%9C%AC%E8%B4%A8%E4%B8%8D%E5%90%8C%E5%BA%8F%E5%88%97%E4%B8%AA%E6%95%B0"><span class="nav-number">1.1.</span> <span class="nav-text">长度为n, 可选[1,m]的本质不同序列个数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%92%E6%8E%A8%E7%BB%84%E5%90%88%E6%95%B0"><span class="nav-number">1.2.</span> <span class="nav-text">递推组合数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0"><span class="nav-number"></span> <span class="nav-text">生成函数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ogf"><span class="nav-number">1.</span> <span class="nav-text">OGF</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E5%85%AC%E5%BC%8F"><span class="nav-number">1.1.</span> <span class="nav-text">常用公式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9D%82%E9%A1%B9"><span class="nav-number"></span> <span class="nav-text">杂项</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%82%E4%B9%B1%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="nav-number">1.</span> <span class="nav-text">杂乱的知识点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%BE%E5%85%B0%E5%AE%9A%E7%90%86"><span class="nav-number">2.</span> <span class="nav-text">图兰定理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pick%E5%AE%9A%E7%90%86"><span class="nav-number">3.</span> <span class="nav-text">Pick定理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cayley%E5%85%AC%E5%BC%8F"><span class="nav-number">4.</span> <span class="nav-text">Cayley公式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#polya%E5%AE%9A%E7%90%861"><span class="nav-number">5.</span> <span class="nav-text">Polya定理1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%90%E4%BA%9B%E6%95%B0%E5%88%97"><span class="nav-number">6.</span> <span class="nav-text">某些数列</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E6%95%B0%E5%A5%87%E5%81%B6%E6%80%A7"><span class="nav-number">7.</span> <span class="nav-text">组合数奇偶性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E6%88%902%E8%BF%9B%E5%88%B6%E6%81%B0%E5%A5%BD%E5%8C%85%E5%90%ABk%E4%BD%8D%E7%9A%84%E4%B8%8B%E4%B8%80%E4%B8%AA%E6%95%B0"><span class="nav-number">8.</span> <span class="nav-text">生成2进制恰好包含k位的下一个数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B1%82%E5%8C%BA%E9%97%B4nm%E5%86%85%E4%B8%8D%E5%90%AB%E5%B9%B3%E6%96%B9%E5%9B%A0%E5%AD%90%E7%9A%84%E6%95%B0"><span class="nav-number">9.</span> <span class="nav-text">求区间[n,m]内不含平方因子的数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%89%E6%AF%94%E6%95%B0%E5%88%97"><span class="nav-number">10.</span> <span class="nav-text">等比数列</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B1%82%E5%92%8C"><span class="nav-number">10.1.</span> <span class="nav-text">求和</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B1%82%E7%A7%AF"><span class="nav-number">10.2.</span> <span class="nav-text">求积</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%90%E9%9B%86"><span class="nav-number">11.</span> <span class="nav-text">子集</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%9A%E4%B8%BE%E5%AD%90%E9%9B%86"><span class="nav-number">11.1.</span> <span class="nav-text">枚举子集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%90%E9%9B%86%E5%92%8C%E9%AB%98%E7%BB%B4%E5%89%8D%E7%BC%80%E5%92%8C"><span class="nav-number">11.2.</span> <span class="nav-text">子集和&#x2F;高维前缀和</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">LinkinPony</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">35</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">37</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/LinkinPony" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;LinkinPony" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://codeforces.com/profile/LinkinPony" title="CodeForces → https:&#x2F;&#x2F;codeforces.com&#x2F;profile&#x2F;LinkinPony" rel="noopener" target="_blank"><i class="code fa-fw"></i>CodeForces</a>
      </span>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://acker.fun/" title="https:&#x2F;&#x2F;acker.fun&#x2F;" rel="noopener" target="_blank">Acker</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://kmguan-528.github.io/" title="https:&#x2F;&#x2F;kmguan-528.github.io&#x2F;" rel="noopener" target="_blank">KMGuan</a>
        </li>
    </ul>
  </div>

          </div>
        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://linkinpony.github.io/2020/05/09/template-math/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="LinkinPony">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="I always love dashie">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          [模板]数学
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-05-09 01:09:32" itemprop="dateCreated datePublished" datetime="2020-05-09T01:09:32+08:00">2020-05-09</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-08-22 07:35:47" itemprop="dateModified" datetime="2021-08-22T07:35:47+08:00">2021-08-22</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%A8%A1%E6%9D%BF/" itemprop="url" rel="index"><span itemprop="name">模板</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>212370440130137957</p>
<p>(↑这是一个很大的质数)</p>
<p>19260817</p>
<p>(↑这是一颗很大的子弹)</p>
<p><strong>判断同余时用</strong><span class="math inline">\((a - b) \mod m== 0\)</span></p>
<p>cout不使用科学计数法输出，设置精度: <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cout.<span class="built_in">setf</span>(ios::fixed,ios::floatfield);</span><br><span class="line">cout.<span class="built_in">precision</span>(<span class="number">2</span>); </span><br></pre></td></tr></table></figure></p>
<table style="width:6%;">
<colgroup>
<col style="width: 5%" />
</colgroup>
<tbody>
<tr class="odd">
<td># 杂项</td>
</tr>
<tr class="even">
<td>## 大整数</td>
</tr>
<tr class="odd">
<td>(我也不知道从哪copy)的</td>
</tr>
<tr class="even">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">bign</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> d[maxn], len;</span><br><span class="line"> </span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">clean</span><span class="params">()</span> </span>&#123; <span class="keyword">while</span>(len &gt; <span class="number">1</span> &amp;&amp; !d[len<span class="number">-1</span>]) len--; &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">bign</span>() 			&#123; <span class="built_in">memset</span>(d, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(d)); len = <span class="number">1</span>; &#125;</span><br><span class="line">    <span class="built_in">bign</span>(<span class="keyword">int</span> num) 	&#123; *<span class="keyword">this</span> = num; &#125; </span><br><span class="line">	<span class="built_in">bign</span>(<span class="keyword">char</span>* num) &#123; *<span class="keyword">this</span> = num; &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> = (<span class="keyword">const</span> <span class="keyword">char</span>* num)&#123;</span><br><span class="line">        <span class="built_in">memset</span>(d, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(d)); len = <span class="built_in">strlen</span>(num);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) d[i] = num[len<span class="number">-1</span>-i] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="built_in">clean</span>();</span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> = (<span class="keyword">int</span> num)&#123;</span><br><span class="line">        <span class="keyword">char</span> s[<span class="number">20</span>]; <span class="built_in">sprintf</span>(s, <span class="string">&quot;%d&quot;</span>, num);</span><br><span class="line">        *<span class="keyword">this</span> = s;</span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    bign <span class="keyword">operator</span> + (<span class="keyword">const</span> bign&amp; b)&#123;</span><br><span class="line">        bign c = *<span class="keyword">this</span>; <span class="keyword">int</span> i;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; b.len; i++)&#123;</span><br><span class="line">        	c.d[i] += b.d[i];</span><br><span class="line">        	<span class="keyword">if</span> (c.d[i] &gt; <span class="number">9</span>) c.d[i]%=<span class="number">10</span>, c.d[i+<span class="number">1</span>]++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span> (c.d[i] &gt; <span class="number">9</span>) c.d[i++]%=<span class="number">10</span>, c.d[i]++;</span><br><span class="line">		c.len = <span class="built_in">max</span>(len, b.len);</span><br><span class="line">		<span class="keyword">if</span> (c.d[i] &amp;&amp; c.len &lt;= i) c.len = i+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> - (<span class="keyword">const</span> bign&amp; b)&#123;</span><br><span class="line">        bign c = *<span class="keyword">this</span>; <span class="keyword">int</span> i;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; b.len; i++)&#123;</span><br><span class="line">        	c.d[i] -= b.d[i];</span><br><span class="line">        	<span class="keyword">if</span> (c.d[i] &lt; <span class="number">0</span>) c.d[i]+=<span class="number">10</span>, c.d[i+<span class="number">1</span>]--;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span> (c.d[i] &lt; <span class="number">0</span>) c.d[i++]+=<span class="number">10</span>, c.d[i]--;</span><br><span class="line">		c.<span class="built_in">clean</span>();</span><br><span class="line">		<span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> * (<span class="keyword">const</span> bign&amp; b)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i, j; bign c; c.len = len + b.len; </span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; b.len; j++) <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; len; i++) </span><br><span class="line">			c.d[i+j] += d[i] * b.d[j];</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; c.len<span class="number">-1</span>; i++)</span><br><span class="line">            c.d[i+<span class="number">1</span>] += c.d[i]/<span class="number">10</span>, c.d[i] %= <span class="number">10</span>;</span><br><span class="line">        c.<span class="built_in">clean</span>();</span><br><span class="line">		<span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> / (<span class="keyword">const</span> bign&amp; b)&#123;</span><br><span class="line">    	<span class="keyword">int</span> i, j;</span><br><span class="line">		bign c = *<span class="keyword">this</span>, a = <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">for</span> (i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    	&#123;</span><br><span class="line">    		a = a*<span class="number">10</span> + d[i];</span><br><span class="line">    		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">10</span>; j++) <span class="keyword">if</span> (a &lt; b*(j+<span class="number">1</span>)) <span class="keyword">break</span>;</span><br><span class="line">    		c.d[i] = j;</span><br><span class="line">    		a = a - b*j;</span><br><span class="line">    	&#125;</span><br><span class="line">    	c.<span class="built_in">clean</span>();</span><br><span class="line">    	<span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    bign <span class="keyword">operator</span> % (<span class="keyword">const</span> bign&amp; b)&#123;</span><br><span class="line">    	<span class="keyword">int</span> i, j;</span><br><span class="line">		bign a = <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">for</span> (i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    	&#123;</span><br><span class="line">    		a = a*<span class="number">10</span> + d[i];</span><br><span class="line">    		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">10</span>; j++) <span class="keyword">if</span> (a &lt; b*(j+<span class="number">1</span>)) <span class="keyword">break</span>;</span><br><span class="line">    		a = a - b*j;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">	bign <span class="keyword">operator</span> += (<span class="keyword">const</span> bign&amp; b)&#123;</span><br><span class="line">        *<span class="keyword">this</span> = *<span class="keyword">this</span> + b;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> bign&amp; b) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(len != b.len) <span class="keyword">return</span> len &lt; b.len;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = len<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">            <span class="keyword">if</span>(d[i] != b.d[i]) <span class="keyword">return</span> d[i] &lt; b.d[i];</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &gt;(<span class="keyword">const</span> bign&amp; b) <span class="keyword">const</span>&#123;<span class="keyword">return</span> b &lt; *<span class="keyword">this</span>;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;=(<span class="keyword">const</span> bign&amp; b) <span class="keyword">const</span>&#123;<span class="keyword">return</span> !(b &lt; *<span class="keyword">this</span>);&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&gt;=(<span class="keyword">const</span> bign&amp; b) <span class="keyword">const</span>&#123;<span class="keyword">return</span> !(*<span class="keyword">this</span> &lt; b);&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>!=(<span class="keyword">const</span> bign&amp; b) <span class="keyword">const</span>&#123;<span class="keyword">return</span> b &lt; *<span class="keyword">this</span> || *<span class="keyword">this</span> &lt; b;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> bign&amp; b) <span class="keyword">const</span>&#123;<span class="keyword">return</span> !(b &lt; *<span class="keyword">this</span>) &amp;&amp; !(b &gt; *<span class="keyword">this</span>);&#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">()</span> <span class="keyword">const</span></span>&#123;</span><br><span class="line">        <span class="keyword">char</span> s[maxn]=&#123;&#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) s[len<span class="number">-1</span>-i] = d[i]+<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">istream&amp; <span class="keyword">operator</span> &gt;&gt; (istream&amp; in, bign&amp; x)</span><br><span class="line">&#123;</span><br><span class="line">    string s;</span><br><span class="line">    in &gt;&gt; s;</span><br><span class="line">    x = s.<span class="built_in">c_str</span>();</span><br><span class="line">    <span class="keyword">return</span> in;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">ostream&amp; <span class="keyword">operator</span> &lt;&lt; (ostream&amp; out, <span class="keyword">const</span> bign&amp; x)</span><br><span class="line">&#123;</span><br><span class="line">    out &lt;&lt; x.<span class="built_in">str</span>();</span><br><span class="line">    <span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="odd">
<td>使用例:</td>
</tr>
<tr class="even">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">bign <span class="title">GCD</span><span class="params">(bign a,bign b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// cout&lt;&lt;&quot;@@@ &quot;&lt;&lt;a&lt;&lt;endl&lt;&lt;&quot;### &quot;&lt;&lt;b&lt;&lt;endl;;</span></span><br><span class="line">	bign k=<span class="number">0</span>,c;</span><br><span class="line">	<span class="keyword">while</span>(b&gt;k)</span><br><span class="line">	&#123;</span><br><span class="line">		c=a%b;</span><br><span class="line">		a=b;</span><br><span class="line">		b=c;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="keyword">int</span> vis[<span class="number">110</span>];</span><br><span class="line">vector &lt;bign&gt; prime;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">GetPrime</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">long</span> <span class="keyword">long</span> i=<span class="number">2</span>;;i+=<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> flag=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">long</span> <span class="keyword">long</span> j=<span class="number">2</span>;j&lt;i;j+=<span class="number">1</span>)</span><br><span class="line">			<span class="keyword">if</span>(i%j==<span class="number">0</span>) flag=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(flag)</span><br><span class="line">		&#123;</span><br><span class="line">			bign k=i;</span><br><span class="line">			prime.<span class="built_in">push_back</span>(k);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>((<span class="keyword">int</span>)prime.<span class="built_in">size</span>()&gt;<span class="number">100</span>) <span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin&gt;&gt;T;</span><br><span class="line">	<span class="built_in">GetPrime</span>();</span><br><span class="line">	<span class="keyword">while</span>(T--)</span><br><span class="line">	&#123;</span><br><span class="line">		bign n;</span><br><span class="line">		cin&gt;&gt;n;</span><br><span class="line">		bign a=<span class="number">1</span>,b=<span class="number">1</span>,k=<span class="number">1</span>,sum=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">int</span> pos=<span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(sum*prime[i]&lt;=n) sum=sum*prime[i],pos=i;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line"> </span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=pos;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			</span><br><span class="line">			b=b*prime[i];</span><br><span class="line">			a=a*(prime[i]+k);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// cout&lt;&lt;&quot;@@@ &quot;&lt;&lt;s&lt;&lt;endl;</span></span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		bign s=<span class="built_in">GCD</span>(a,b);</span><br><span class="line">		b=b/s,a=a/s;</span><br><span class="line">		cout&lt;&lt;b&lt;&lt;<span class="string">&quot;/&quot;</span>&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="odd">
<td>## 随机数发生器</td>
</tr>
<tr class="even">
<td>注意不要用Windows下的<span class="math inline">\(rand()\)</span></td>
</tr>
<tr class="odd">
<td><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mt19937 Rand(seed);</span><br><span class="line">mt19937 Rand(chrono::steady_clock::now().time_since_epoch().count());//cf最好用这个防止被hack</span><br><span class="line">Rand();//返回一个随机数</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="even">
<td>### 均匀分布</td>
</tr>
<tr class="odd">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 包含random头文件</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;random&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//定义均匀分布对象，均匀分布区间（a,b)为(-10，10)</span></span><br><span class="line">	std::uniform_int_distribution&lt;<span class="keyword">int</span>&gt; uid&#123; <span class="number">-10</span>,<span class="number">10</span> &#125;;</span><br><span class="line">	<span class="comment">//均匀分布区间(a,b)</span></span><br><span class="line">	std::cout &lt;&lt; uid.<span class="built_in">a</span>() &lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt; uid.<span class="built_in">b</span>() &lt;&lt; std::endl;</span><br><span class="line">	<span class="comment">//定义随机数种子</span></span><br><span class="line">	std::random_device rd;</span><br><span class="line">	<span class="comment">//定义默认随机数生成器</span></span><br><span class="line">	std::default_random_engine dre&#123; <span class="built_in">rd</span>() &#125;;</span><br><span class="line">	std::cout &lt;&lt; <span class="string">&quot;五个随机数如下&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; ++i)</span><br><span class="line">		std::cout &lt;&lt; <span class="built_in">uid</span>(dre) &lt;&lt; std::endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="even">
<td>## 计时</td>
</tr>
<tr class="odd">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">clock_t</span> start = <span class="built_in">clock</span>();</span><br><span class="line"><span class="comment">// do something...</span></span><br><span class="line"><span class="keyword">clock_t</span> end   = <span class="built_in">clock</span>();</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;花费了&quot;</span> &lt;&lt; (<span class="keyword">double</span>)(end - start) / CLOCKS_PER_SEC &lt;&lt; <span class="string">&quot;秒&quot;</span> &lt;&lt; endl;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="even">
<td># 数论</td>
</tr>
<tr class="odd">
<td>## 快速幂</td>
</tr>
<tr class="even">
<td>计算<span class="math inline">\(x^d \mod p\)</span></td>
</tr>
<tr class="odd">
<td>注意<span class="math inline">\(a^b % p = ((a % p)^b) % p\)</span></td>
</tr>
<tr class="even">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">Pow</span><span class="params">(ll x,ll d)</span></span>&#123;</span><br><span class="line">	ll tans = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(d == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">1</span>%p;</span><br><span class="line">	ll a = <span class="built_in">Pow</span>(x,d/<span class="number">2</span>);</span><br><span class="line">	tans = a*a%p;</span><br><span class="line">	<span class="keyword">if</span>(d%<span class="number">2</span>)tans = tans*x%p; </span><br><span class="line">	<span class="keyword">return</span> tans%p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">gcd</span><span class="params">(LL a,LL b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(b)</span><br><span class="line">    &#123;</span><br><span class="line">        LL tmp=b;</span><br><span class="line">        b=a%b;</span><br><span class="line">        a=tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="odd">
<td>## GCD &amp; exGCD</td>
</tr>
<tr class="even">
<td>x,y,d为全局变量.求x和y使得 <span class="math inline">\(ax + by = d\)</span> 且 <span class="math inline">\(|x| + |y|\)</span>最小.</td>
</tr>
<tr class="odd">
<td>其中 <span class="math inline">\(d = gcd(a,b)\)</span></td>
</tr>
<tr class="even">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">gcd</span><span class="params">(ll a,ll b,ll &amp; d,ll &amp; x,ll &amp; y)</span></span>&#123;</span><br><span class="line">	<span class="comment">//notice d = gcd(a,b)</span></span><br><span class="line">	<span class="keyword">if</span>(!b)d = a,x = <span class="number">1</span>,y = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">gcd</span>(b,a%b,d,y,x);</span><br><span class="line">		y -= x*(a/b);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="odd">
<td>## 逆元</td>
</tr>
<tr class="even">
<td>返回模p下a的逆.不存在则返回-1.</td>
</tr>
<tr class="odd">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">inv</span><span class="params">(ll a,ll p)</span></span>&#123;</span><br><span class="line">	ll d,x,y;</span><br><span class="line">	<span class="built_in">gcd</span>(a,p,d,x,y);</span><br><span class="line">	<span class="keyword">return</span> d == <span class="number">1</span>?(x+p)%p:<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> ### 线性筛逆元:</td>
</tr>
<tr class="even">
<td>返回模p下1...n的逆.保存在invs里</td>
</tr>
<tr class="odd">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_inv</span><span class="params">()</span></span>&#123;</span><br><span class="line">	inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; maxn;i++)&#123;</span><br><span class="line">		inv[i] = (ll)(p - p/i)*inv[p%i]%p;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="even">
<td>## a,b不互质时</td>
</tr>
<tr class="odd">
<td><span class="math display">\[
\frac{a}{b} \mod m = \frac{a \mod (mb)}{b}
\]</span></td>
</tr>
<tr class="even">
<td>证: <span class="math display">\[
\begin{align}
&amp;\frac{a}{b} = km + x (x &lt; m)\\
\Rightarrow \space &amp;a =kbm + bx\\
\Rightarrow \space &amp;a \mod (bm) = bx\\
\Rightarrow \space &amp;\frac{a \mod (bm)}{b} = x\\
\Rightarrow \space &amp;\frac{a \mod (bm)}{b} = \frac{a}{b} \mod m
\end{align}
\]</span></td>
</tr>
<tr class="odd">
<td>## 中国剩余定理(CRT)</td>
</tr>
<tr class="even">
<td>求同余方程组 <span class="math display">\[
\begin{cases} x &amp;\equiv a_1 \pmod {m_1} \\ x &amp;\equiv a_2 \pmod {m_2} \\ &amp;\vdots \\ x &amp;\equiv a_k \pmod {m_k} \\ \end{cases}
\]</span> 在<span class="math inline">\([0,\prod_{i = 1}^nm_i])\)</span>中的解. 要求任意<span class="math inline">\(m_i\)</span>两两互质</td>
</tr>
<tr class="odd">
<td>输入: <code>int n</code> 方程组个数, <code>ll a[] ll m[]</code>,方程组的参数和模数</td>
</tr>
<tr class="even">
<td>复杂度:<span class="math inline">\(O(nlogM)\)</span>, 其中<span class="math inline">\(M\)</span>与<span class="math inline">\(m_i\)</span>同阶</td>
</tr>
<tr class="odd">
<td>输出: 方程组在<span class="math inline">\([0,\prod_{i = 1}^nm_i])\)</span>中的解.</td>
</tr>
<tr class="even">
<td>前置: 逆元</td>
</tr>
<tr class="odd">
<td>调用 <code>CRT(n,a,m)</code></td>
</tr>
<tr class="even">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">CRT</span><span class="params">(<span class="keyword">int</span> n,ll * a,ll * m)</span></span>&#123;</span><br><span class="line">	ll M = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)M *= m[i];</span><br><span class="line">	ll ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">		ll mt = M/m[i];</span><br><span class="line">		ll ret = <span class="built_in">inv</span>(mt,m[i]);</span><br><span class="line">		ans = (ans + a[i]*mt%M*ret%M)%M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> (ans + M)%M;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="odd">
<td>## Eratosthenes筛</td>
</tr>
<tr class="even">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prime</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(!n_prime[i])&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = i*<span class="number">2</span>;j &lt;= n;j += i)n_prime[j] = <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	n_prime[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="odd">
<td>## 线性筛</td>
</tr>
<tr class="even">
<td>### 线性筛素数以及<span class="math inline">\(\varphi\)</span></td>
</tr>
<tr class="odd">
<td>(大多数线性筛都要筛素数)</td>
</tr>
<tr class="even">
<td>phi[n]为<span class="math inline">\(\varphi(n)\)</span>,prime里存的素数</td>
</tr>
<tr class="odd">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> phi[maxn];</span><br><span class="line"><span class="keyword">bool</span> not_p[maxn];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt;prime;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">eular_sieve</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	not_p[<span class="number">1</span>] = phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; n;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(!not_p[i])&#123;</span><br><span class="line">			phi[i] = i<span class="number">-1</span>;</span><br><span class="line">			prime.<span class="built_in">push_back</span>(i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> p:prime)&#123;</span><br><span class="line">			<span class="keyword">if</span>((ll)p*i &gt;= n)<span class="keyword">break</span>;</span><br><span class="line">			not_p[p*i] = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(i%p)phi[i*p] = phi[i]*(p<span class="number">-1</span>);</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				phi[i*p] = phi[i]*p;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="even">
<td>### 线性筛<span class="math inline">\(\mu\)</span></td>
</tr>
<tr class="odd">
<td><span class="math display">\[
\mu(n)= \begin{cases} 1&amp;n=1\\ 0&amp;n\text{ 含有平方因子}\\ (-1)^k&amp;k\text{ 为 }n\text{ 的本质不同质因子个数}\\ \end{cases}
\]</span></td>
</tr>
<tr class="even">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> phi[maxn],mu[maxn];</span><br><span class="line"><span class="keyword">bool</span> not_p[maxn];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt;prime;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve_mu</span><span class="params">()</span></span>&#123;</span><br><span class="line">	not_p[<span class="number">1</span>] = mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; maxn;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(!not_p[i])&#123;</span><br><span class="line">			mu[i] = <span class="number">-1</span>;</span><br><span class="line">			prime.<span class="built_in">push_back</span>(i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> p:prime)&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">ll</span>(p)*i &gt;= maxn)<span class="keyword">break</span>;</span><br><span class="line">			not_p[p*i] = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(i%p)mu[i*p] = -mu[i];</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				mu[i*p] = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="odd">
<td>## 杜教筛</td>
</tr>
<tr class="even">
<td>详细请见杜教筛笔记.</td>
</tr>
<tr class="odd">
<td>杜教筛快速筛<span class="math inline">\(\varphi\)</span>和<span class="math inline">\(\mu\)</span>的前缀和.<span class="math inline">\(maxn = n^{\frac{2}{3}}\)</span>时复杂度为<span class="math inline">\(O(n^{\frac{2}{3}})\)</span></td>
</tr>
<tr class="even">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1664510</span>;</span><br><span class="line"><span class="keyword">bool</span> not_p[maxn];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt;prime;</span><br><span class="line">ll mu[maxn],phi[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	phi[<span class="number">1</span>] = mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; maxn;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(!not_p[i])&#123;</span><br><span class="line">			mu[i] = <span class="number">-1</span>;</span><br><span class="line">			phi[i] = i<span class="number">-1</span>;</span><br><span class="line">			prime.<span class="built_in">push_back</span>(i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> p:prime)&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="number">1LL</span>*p*i &gt;= maxn)<span class="keyword">break</span>;</span><br><span class="line">			not_p[i*p] = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(i%p)&#123;</span><br><span class="line">				phi[i*p] = phi[i]*(p<span class="number">-1</span>);</span><br><span class="line">				mu[i*p] = -mu[i];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				phi[i*p] = phi[i]*p;</span><br><span class="line">				mu[i*p] = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line"> 		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; maxn;i++)mu[i] += mu[i<span class="number">-1</span>],phi[i] += phi[i<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line">map&lt;<span class="keyword">int</span>,ll&gt;Mu,Phi;</span><br><span class="line"><span class="function">ll <span class="title">du_mu</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x &lt; maxn)<span class="keyword">return</span> mu[x];</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(Mu[x])<span class="keyword">return</span> Mu[x];</span><br><span class="line">	ll tans = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> l = <span class="number">2</span>,r = <span class="number">0</span>;l &lt;= x;l = r+<span class="number">1</span>)&#123;</span><br><span class="line">		r = x/(x/l);</span><br><span class="line">		tans -= <span class="number">1LL</span>*(r - l + <span class="number">1</span>)*<span class="built_in">du_mu</span>(x/l);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> Mu[x] = tans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">du_phi</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x &lt; maxn)<span class="keyword">return</span> phi[x];</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(Phi[x])<span class="keyword">return</span> Phi[x];</span><br><span class="line">	ll tans = <span class="number">1LL</span>*x*(x+<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> l = <span class="number">2</span>,r = <span class="number">0</span>;l &lt;= x;l = r+<span class="number">1</span>)&#123;</span><br><span class="line">		r = x/(x/l);</span><br><span class="line">		tans -= <span class="number">1LL</span>*(r-l+<span class="number">1</span>)*<span class="built_in">du_phi</span>(x/l);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> Phi[x] = tans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="odd">
<td>## 欧拉函数<span class="math inline">\(φ(x)\)</span></td>
</tr>
<tr class="even">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">cal_phi</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> m = (ll)<span class="built_in">sqrt</span>(x+<span class="number">0.5</span>);</span><br><span class="line">	ll tans = x;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= m;i++)<span class="keyword">if</span>(!(x%i))&#123;</span><br><span class="line">		tans = tans/i*(i<span class="number">-1</span>);</span><br><span class="line">		<span class="keyword">while</span>(!(x%i))x /= i;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(x &gt; <span class="number">1</span>)tans = tans / x * (x<span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">return</span> tans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="odd">
<td>### 线性筛<span class="math inline">\(φ(x)\)</span></td>
</tr>
<tr class="even">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve_phi</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)<span class="keyword">if</span>(!phi[i])</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = i;j &lt;= n;j += i)&#123;</span><br><span class="line">			<span class="keyword">if</span>(!phi[j])phi[j] = j;</span><br><span class="line">			phi[j] = phi[j]/i * (i<span class="number">-1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="odd">
<td>## 有理数取模</td>
</tr>
<tr class="even">
<td>求<span class="math inline">\(a/b\)</span> % <span class="math inline">\(p\)</span> （p为质数)</td>
</tr>
<tr class="odd">
<td>由费马小定理<span class="math inline">\(b^{p-1} ≡ 1 \pmod p\)</span> 可得 <span class="math inline">\(b^{p-2} ≡ b^{-1} \pmod p\)</span></td>
</tr>
<tr class="even">
<td>故只需求<span class="math inline">\(a*b^{p-2} \bmod p\)</span></td>
</tr>
<tr class="odd">
<td>a,b过大则先膜一下</td>
</tr>
<tr class="even">
<td>## 欧拉定理</td>
</tr>
<tr class="odd">
<td>若<span class="math inline">\(a,p\)</span>互质,则有</td>
</tr>
<tr class="even">
<td><span class="math inline">\(a^{φ(p)} ≡ 1 \pmod p\)</span></td>
</tr>
<tr class="odd">
<td>### 扩展欧拉定理(无需a,p互质)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(b ≥ φ(p)\)</span>时:</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(a^b ≡ a^{b \bmod φ(p) +φ(p)} \pmod p\)</span></td>
</tr>
<tr class="even">
<td>例题: 给出<span class="math inline">\(w_1,w_2,..w_n\)</span>和<span class="math inline">\(q\)</span>组询问<span class="math inline">\(l \space r\)</span>. 求<span class="math inline">\(w_l^{w_{l+1}^{...^{w_r}}} \pmod p\)</span>的值</td>
</tr>
<tr class="odd">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//CF906D </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line">ll raw[maxn],n,mod;</span><br><span class="line">map&lt;ll,ll&gt;vis;</span><br><span class="line"><span class="function">ll <span class="title">phi</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> m = (ll)<span class="built_in">sqrt</span>(x+<span class="number">0.5</span>);</span><br><span class="line">	ll tans = x;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= m;i++)<span class="keyword">if</span>(!(x%i))&#123;</span><br><span class="line">		tans = tans/i*(i<span class="number">-1</span>);</span><br><span class="line">		<span class="keyword">while</span>(!(x%i))x /= i;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(x &gt; <span class="number">1</span>)tans = tans / x * (x<span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">return</span> tans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">upd</span><span class="params">(ll x,ll p)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x&lt;p?x:x%p+p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">Pow</span><span class="params">(ll x,ll d,ll p)</span></span>&#123;</span><br><span class="line">	ll tans = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(d == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	ll a = <span class="built_in">Pow</span>(x,d/<span class="number">2</span>,p);</span><br><span class="line">	tans = <span class="built_in">upd</span>(a*a,p);</span><br><span class="line">	<span class="keyword">if</span>(d%<span class="number">2</span>)tans = <span class="built_in">upd</span>(tans*x,p); </span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">upd</span>(tans,p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">cal</span><span class="params">(ll l,ll r,ll p)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(l == r <span class="keyword">or</span> p == <span class="number">1</span>)<span class="keyword">return</span> <span class="built_in">upd</span>(raw[l],p);</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">Pow</span>(raw[l],<span class="built_in">cal</span>(l+<span class="number">1</span>,r,vis[p]),p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin &gt;&gt; n &gt;&gt; mod;</span><br><span class="line">	ll qwq = mod;</span><br><span class="line">	<span class="keyword">while</span>(qwq != <span class="number">1</span>)&#123;</span><br><span class="line">		vis[qwq] = <span class="built_in">phi</span>(qwq);</span><br><span class="line">		qwq = vis[qwq];</span><br><span class="line">	&#125;</span><br><span class="line">	vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)cin &gt;&gt; raw[i];</span><br><span class="line">	<span class="keyword">int</span> q;</span><br><span class="line">	cin &gt;&gt; q;</span><br><span class="line">	<span class="keyword">while</span>(q--)&#123;</span><br><span class="line">		<span class="keyword">int</span> l,r;</span><br><span class="line">		cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">		cout &lt;&lt; <span class="built_in">cal</span>(l,r,mod)%mod &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="even">
<td>## 原根</td>
</tr>
<tr class="odd">
<td><code>proot(p)</code> 返回素数p的原根</td>
</tr>
<tr class="even">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="keyword">int</span>&gt;pri;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">g_test</span><span class="params">(ll g,ll p)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(ll x:pri)&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">Pow</span>(g,(p<span class="number">-1</span>)/x,p) == <span class="number">1</span>)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">proot</span><span class="params">(ll p)</span></span>&#123;</span><br><span class="line">	ll tmp = p<span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span>(ll i = <span class="number">2</span>;i &lt;= tmp/i;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(tmp%i == <span class="number">0</span>)&#123;</span><br><span class="line">			pri.<span class="built_in">push_back</span>(i);</span><br><span class="line">			<span class="keyword">while</span>(tmp%i == <span class="number">0</span>)tmp /= i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(tmp != <span class="number">1</span>)pri.<span class="built_in">push_back</span>(tmp);</span><br><span class="line">	ll g = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">g_test</span>(g,p))<span class="keyword">return</span> g;</span><br><span class="line">		g++;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="odd">
<td>## 离散对数(BSGS)</td>
</tr>
<tr class="even">
<td><code>log_mod(ll a,ll b,ll p)</code>返回最小的<span class="math inline">\(x\)</span>使得<span class="math inline">\(a^x \equiv b\pmod{p}\)</span>, 不存在则返回<span class="math inline">\(-1\)</span>. 要求<span class="math inline">\(p\)</span>为素数. 时间复杂度<span class="math inline">\(O(\sqrt p)\)</span></td>
</tr>
<tr class="odd">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">log_mod</span><span class="params">(ll a,ll b,ll p)</span></span>&#123;</span><br><span class="line">	<span class="comment">//return a^x = b % p</span></span><br><span class="line">	<span class="keyword">int</span> m,v,e = <span class="number">1</span>;</span><br><span class="line">	m = (<span class="keyword">int</span>)<span class="built_in">sqrt</span>(p);</span><br><span class="line">	v = <span class="built_in">Pow</span>(<span class="built_in">Pow</span>(a,m),p<span class="number">-2</span>);</span><br><span class="line">	map&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;rec;</span><br><span class="line">	rec[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i++)&#123;</span><br><span class="line">		e = e*a%p;</span><br><span class="line">		<span class="keyword">if</span>(!rec.<span class="built_in">count</span>(e))rec[e] = i;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(rec.<span class="built_in">count</span>(b))<span class="keyword">return</span> i*m + rec[b];</span><br><span class="line">		b = b*v%p;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="even">
<td>## 拉格朗日插值</td>
</tr>
<tr class="odd">
<td>px,py为点坐标,p为模数,k是L(k)那个k inv为逆元</td>
</tr>
<tr class="even">
<td>返回L(k)</td>
</tr>
<tr class="odd">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">lagrange</span><span class="params">(ll n,ll k)</span></span>&#123;</span><br><span class="line">	ll tans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">		ll f = <span class="number">1</span>,g = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j++)<span class="keyword">if</span>(i != j)&#123;</span><br><span class="line">			f = f*(k - px[j]+p)%p;</span><br><span class="line">			g = g*(px[i] - px[j]+p)%p;</span><br><span class="line">		&#125;</span><br><span class="line">		ll lota = py[i]*f%p*<span class="built_in">inv</span>(g,p)%p;</span><br><span class="line">		tans = (tans+lota)%p;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> tans; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="even">
<td>### 线性求<span class="math inline">\(\sum_{i = 0}^{n}i^k\)</span></td>
</tr>
<tr class="odd">
<td>(返回L(k)的值,多项式次数为n.按需更改yi的值,复杂度<span class="math inline">\(O(k)\)</span>)</td>
</tr>
<tr class="even">
<td>(注意求<span class="math inline">\(\sum_{i = 0}^{n}i^k\)</span>需要调用line_lagrange(k+2,n) )</td>
</tr>
<tr class="odd">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">line_lagrange</span><span class="params">(ll n,ll k)</span></span>&#123;</span><br><span class="line">	ll tans = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">get_inv</span>();</span><br><span class="line">	pre[<span class="number">0</span>] = suf[n+<span class="number">1</span>] = ifac[<span class="number">0</span>] =  <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">		pre[i] = pre[i<span class="number">-1</span>]*(k-i)%mod;</span><br><span class="line">		ifac[i] = ifac[i<span class="number">-1</span>]*invs[i]%mod;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = n;i &gt;= <span class="number">0</span>;i--)suf[i] = suf[i+<span class="number">1</span>]*(k-i)%mod;</span><br><span class="line">	ll yi = <span class="number">0</span>; </span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">		yi = (yi+<span class="built_in">pow_mod</span>(i,n<span class="number">-2</span>))%mod;</span><br><span class="line">		ll a = pre[i<span class="number">-1</span>]*suf[i+<span class="number">1</span>]%mod*yi%mod*ifac[i<span class="number">-1</span>]%mod*ifac[n-i]%mod;</span><br><span class="line">		<span class="keyword">if</span>((n-i)%<span class="number">2</span>)a = mod-a; </span><br><span class="line">		tans = (tans+a+mod)%mod;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> tans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
<tr class="even">
<td>## 卢卡斯定理</td>
</tr>
<tr class="odd">
<td>Lucas(n,m) = C(n%p,m%p)*Lucas(n/p,m/p)%p</td>
</tr>
<tr class="even">
<td>p需为素数,fac[]为预处理的阶乘,时间复杂度大约是<span class="math inline">\(O(p + mlogm)\)</span>(预处理需要<span class="math inline">\(O(p)\)</span>)</td>
</tr>
<tr class="odd">
<td><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">C</span><span class="params">(ll n,ll m)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(m &gt; n)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> (fac[n]*<span class="built_in">Pow</span>(fac[m],p<span class="number">-2</span>)%p*<span class="built_in">Pow</span>(fac[n-m],p<span class="number">-2</span>)%p)%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">Lucas</span><span class="params">(ll n,ll m)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!m)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">C</span>(n%p,m%p)*<span class="built_in">Lucas</span>(n/p,m/p)%p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></td>
</tr>
</tbody>
</table>
<h2 id="线性基">线性基</h2>
<p>maxbit取值域位数</p>
<p>insert返回0则说明现有基可以表示x</p>
<p>qmax返回异或最大值</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinerBasis</span>&#123;</span></span><br><span class="line">	ll base[maxbit+<span class="number">4</span>];</span><br><span class="line">	<span class="keyword">bool</span> vis[maxbit+<span class="number">4</span>];</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">insert</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = maxbit;~i;i--)&#123;</span><br><span class="line">			<span class="keyword">if</span>(x&amp;(<span class="number">1LL</span>&lt;&lt;i))&#123;</span><br><span class="line">				<span class="keyword">if</span>(!base[i])&#123;</span><br><span class="line">					base[i] = x;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span> x ^= base[i];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> x;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">ll <span class="title">qmax</span><span class="params">()</span></span>&#123;</span><br><span class="line">		ll ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = maxbit;~i;i--)ans = <span class="built_in">max</span>(ans,ans^base[i]);</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;yay;</span><br></pre></td></tr></table></figure>
<h2 id="杜教bm快速求模意义下线性递推式">杜教BM(快速求模意义下线性递推式)</h2>
<p>设<span class="math inline">\(n\)</span>为输入项数, 复杂度<span class="math inline">\(O(n^2\log n)\)</span>. 对于<span class="math inline">\(k\)</span>阶递推式(例如斐波那契数列为2阶递推式)至少需要前<span class="math inline">\(2k\)</span>项</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for (int i=a;i&lt;n;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SZ(x) ((ll)(x).size())</span></span><br><span class="line"><span class="keyword">typedef</span> vector&lt;ll&gt; VI;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll, ll&gt; PII;</span><br><span class="line"><span class="keyword">const</span> ll mod = <span class="number">1000000007</span>;</span><br><span class="line"><span class="function">ll <span class="title">powmod</span><span class="params">(ll a, ll b)</span> </span>&#123; ll res = <span class="number">1</span>; a %= mod; <span class="built_in">assert</span>(b &gt;= <span class="number">0</span>); <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123; <span class="keyword">if</span> (b &amp; <span class="number">1</span>)res = res * a % mod; a = a * a % mod; &#125;<span class="keyword">return</span> res; &#125;</span><br><span class="line"><span class="comment">// head</span></span><br><span class="line"> </span><br><span class="line">ll _, n;</span><br><span class="line"><span class="keyword">namespace</span> linear_seq &#123;</span><br><span class="line">    <span class="keyword">const</span> ll N = <span class="number">10010</span>;</span><br><span class="line">    ll res[N], base[N], _c[N], _md[N];</span><br><span class="line"> </span><br><span class="line">    vector&lt;ll&gt; Md;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(ll* a, ll* b, ll k)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">rep</span>(i, <span class="number">0</span>, k + k) _c[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">rep</span>(i, <span class="number">0</span>, k) <span class="keyword">if</span> (a[i]) <span class="built_in">rep</span>(j, <span class="number">0</span>, k) _c[i + j] = (_c[i + j] + a[i] * b[j]) % mod;</span><br><span class="line">        <span class="keyword">for</span> (ll i = k + k - <span class="number">1</span>; i &gt;= k; i--) <span class="keyword">if</span> (_c[i])</span><br><span class="line">            <span class="built_in">rep</span>(j, <span class="number">0</span>, <span class="built_in">SZ</span>(Md)) _c[i - k + Md[j]] = (_c[i - k + Md[j]] - _c[i] * _md[Md[j]]) % mod;</span><br><span class="line">        <span class="built_in">rep</span>(i, <span class="number">0</span>, k) a[i] = _c[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">solve</span><span class="params">(ll n, VI a, VI b)</span> </span>&#123; <span class="comment">// a 系数 b 初值 b[n+1]=a[0]*b[n]+...</span></span><br><span class="line"><span class="comment">//        printf(&quot;%d\n&quot;,SZ(b));</span></span><br><span class="line">        ll ans = <span class="number">0</span>, pnt = <span class="number">0</span>;</span><br><span class="line">        ll k = <span class="built_in">SZ</span>(a);</span><br><span class="line">        <span class="built_in">assert</span>(<span class="built_in">SZ</span>(a) == <span class="built_in">SZ</span>(b));</span><br><span class="line">        <span class="built_in">rep</span>(i, <span class="number">0</span>, k) _md[k - <span class="number">1</span> - i] = -a[i]; _md[k] = <span class="number">1</span>;</span><br><span class="line">        Md.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="built_in">rep</span>(i, <span class="number">0</span>, k) <span class="keyword">if</span> (_md[i] != <span class="number">0</span>) Md.<span class="built_in">push_back</span>(i);</span><br><span class="line">        <span class="built_in">rep</span>(i, <span class="number">0</span>, k) res[i] = base[i] = <span class="number">0</span>;</span><br><span class="line">        res[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> ((<span class="number">1ll</span> &lt;&lt; pnt) &lt;= n) pnt++;</span><br><span class="line">        <span class="keyword">for</span> (ll p = pnt; p &gt;= <span class="number">0</span>; p--) &#123;</span><br><span class="line">            <span class="built_in">mul</span>(res, res, k);</span><br><span class="line">            <span class="keyword">if</span> ((n &gt;&gt; p) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (ll i = k - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) res[i + <span class="number">1</span>] = res[i]; res[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">                <span class="built_in">rep</span>(j, <span class="number">0</span>, <span class="built_in">SZ</span>(Md)) res[Md[j]] = (res[Md[j]] - res[k] * _md[Md[j]]) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">rep</span>(i, <span class="number">0</span>, k) ans = (ans + res[i] * b[i]) % mod;</span><br><span class="line">        <span class="keyword">if</span> (ans &lt; <span class="number">0</span>) ans += mod;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">VI <span class="title">BM</span><span class="params">(VI s)</span> </span>&#123;</span><br><span class="line">        <span class="function">VI <span class="title">C</span><span class="params">(<span class="number">1</span>, <span class="number">1</span>)</span>, <span class="title">B</span><span class="params">(<span class="number">1</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">        ll L = <span class="number">0</span>, m = <span class="number">1</span>, b = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">rep</span>(n, <span class="number">0</span>, <span class="built_in">SZ</span>(s)) &#123;</span><br><span class="line">            ll d = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">rep</span>(i, <span class="number">0</span>, L + <span class="number">1</span>) d = (d + (ll)C[i] * s[n - i]) % mod;</span><br><span class="line">            <span class="keyword">if</span> (d == <span class="number">0</span>) ++m;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (<span class="number">2</span> * L &lt;= n) &#123;</span><br><span class="line">                VI T = C;</span><br><span class="line">                ll c = mod - d * <span class="built_in">powmod</span>(b, mod - <span class="number">2</span>) % mod;</span><br><span class="line">                <span class="keyword">while</span> (<span class="built_in">SZ</span>(C) &lt; <span class="built_in">SZ</span>(B) + m) C.<span class="built_in">pb</span>(<span class="number">0</span>);</span><br><span class="line">                <span class="built_in">rep</span>(i, <span class="number">0</span>, <span class="built_in">SZ</span>(B)) C[i + m] = (C[i + m] + c * B[i]) % mod;</span><br><span class="line">                L = n + <span class="number">1</span> - L; B = T; b = d; m = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                ll c = mod - d * <span class="built_in">powmod</span>(b, mod - <span class="number">2</span>) % mod;</span><br><span class="line">                <span class="keyword">while</span> (<span class="built_in">SZ</span>(C) &lt; <span class="built_in">SZ</span>(B) + m) C.<span class="built_in">pb</span>(<span class="number">0</span>);</span><br><span class="line">                <span class="built_in">rep</span>(i, <span class="number">0</span>, <span class="built_in">SZ</span>(B)) C[i + m] = (C[i + m] + c * B[i]) % mod;</span><br><span class="line">                ++m;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> C;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">gao</span><span class="params">(VI a, ll n)</span> </span>&#123;</span><br><span class="line">        VI c = <span class="built_in">BM</span>(a);</span><br><span class="line">        c.<span class="built_in">erase</span>(c.<span class="built_in">begin</span>());</span><br><span class="line">        <span class="built_in">rep</span>(i, <span class="number">0</span>, <span class="built_in">SZ</span>(c)) c[i] = (mod - c[i]) % mod;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">solve</span>(n, c, <span class="built_in">VI</span>(a.<span class="built_in">begin</span>(), a.<span class="built_in">begin</span>() + <span class="built_in">SZ</span>(c)));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;n)) &#123;</span><br><span class="line">        vector&lt;ll&gt;v;</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">1</span>);<span class="comment">//前几项</span></span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">5</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">15</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">35</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">70</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">126</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">210</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">330</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">495</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">715</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">1001</span>);</span><br><span class="line">        <span class="comment">//输入n ,输出第n项的值  一般大于10项即可出答案，越多越好</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, linear_seq::<span class="built_in">gao</span>(v, n - <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="博弈论">博弈论</h1>
<h2 id="威佐夫游戏">威佐夫游戏</h2>
<p>两人轮流取两堆筹码，其中取法有两种：取走一堆中任意个筹码，或从两堆中取走相同数目的筹码。取完所有筹码的一方获胜。</p>
<p>(1为先手胜)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if(n1&gt;n2)  swap(n1,n2);</span><br><span class="line">temp=floor((n2-n1)*(1+sqrt(5.0))/2.0);</span><br><span class="line">if(temp==n1) cout&lt;&lt;&quot;0&quot;&lt;&lt;endl;</span><br><span class="line">else cout&lt;&lt;&quot;1&quot;&lt;&lt;endl;</span><br></pre></td></tr></table></figure>
<h1 id="矩阵">矩阵</h1>
<h2 id="定义快速幂">定义&amp;快速幂</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(i,a,b) for(int i = a;i &lt;= b;i++)</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Martix</span>&#123;</span></span><br><span class="line">	ll A[maxn][maxn];</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">initer</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j++)A[i][j] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)A[i][i] = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	Martix <span class="keyword">operator</span> * (<span class="keyword">const</span> Martix &amp; a)&#123;</span><br><span class="line">		Martix res;</span><br><span class="line">		<span class="built_in">memset</span>(res.A,<span class="number">0</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(res.A));</span><br><span class="line">		<span class="built_in">FOR</span>(k,<span class="number">1</span>,n)</span><br><span class="line">			<span class="built_in">FOR</span>(i,<span class="number">1</span>,n)</span><br><span class="line">				<span class="built_in">FOR</span>(j,<span class="number">1</span>,n)res.A[i][j] = (res.A[i][j] + (A[i][k]*a.A[k][j])%MOD)%MOD;</span><br><span class="line">		<span class="keyword">return</span> res;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;martix,martixI;</span><br><span class="line"><span class="function">Martix <span class="title">martixPow</span><span class="params">(Martix x,ll p)</span></span>&#123;</span><br><span class="line">	Martix ans;</span><br><span class="line">	ans.<span class="built_in">initer</span>();</span><br><span class="line">	<span class="keyword">while</span>(p)&#123;</span><br><span class="line">		<span class="keyword">if</span>(p%<span class="number">2</span>)ans = ans*x;</span><br><span class="line">		x = x*x;</span><br><span class="line">		p /= <span class="number">2</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="置换矩阵">置换矩阵</h2>
<p>每一行每一列有且仅有一个<span class="math inline">\(1\)</span>, 其余元素为<span class="math inline">\(0\)</span>的矩阵为置换矩阵.</p>
<p>置换矩阵的逆是它的转置.</p>
<h2 id="一些例题">一些例题</h2>
<h3 id="加速递推式">加速递推式</h3>
<p>以<span class="math inline">\(Fibonacci\)</span>为例:</p>
<p><span class="math inline">\(f(1) = f(2) = 1,f(n) = f(n-1) + f(n-2),(n \geq 10^9)\)</span>,求<span class="math inline">\(f(n)\)</span></p>
<p>我们有这么一个矩阵:<span class="math inline">\(A = [f(n-1),f(n-2)]\)</span></p>
<p>构造一个矩阵<span class="math inline">\(B\)</span>使得<span class="math inline">\(A*B = [f(n),f(n-1)]\)</span></p>
<p>这里容易看出: <span class="math display">\[
B = \left\{ \begin{matrix}   1 &amp; 1  \\   1 &amp; 0   \end{matrix}  \right\}  
\]</span></p>
<p>我们使 <span class="math display">\[
A =  \left\{ \begin{matrix}   1 &amp; 1  \\   0 &amp; 0   \end{matrix}  \right\}
\]</span> (即递推式的初始项),求<span class="math inline">\(A = A*B^{n-1}\)</span>后,<span class="math inline">\(f(n) = A[1][1]\)</span></p>
<p>其它递推式同理.</p>
<h3 id="求包含严格k条边的方案数最短路">求包含严格k条边的方案数/最短路</h3>
<p>1.无权图求从<span class="math inline">\(i\)</span>到<span class="math inline">\(j\)</span>经过<span class="math inline">\(k\)</span>条边的方案数:求邻接矩阵的<span class="math inline">\(k\)</span>次幂即可</p>
<p>2.有向图求包含<span class="math inline">\(k\)</span>条边的最短路:求邻接矩阵的<span class="math inline">\(k\)</span>次幂,<strong>把普通矩阵乘法改为Floyd</strong></p>
<h1 id="分数规划">0-1分数规划</h1>
<p>给出数列<span class="math inline">\(\{a_i\},\{b_i\}\)</span>,求一组<span class="math inline">\(w_i \in \{0,1\}\)</span>, 使得 <span class="math display">\[
\frac{\sum_{i = 1}^na_i \cdot w_i}{\sum_{i = 1}^nb_i \cdot w_i}
\]</span> 最大或最小</p>
<p>或给出<span class="math inline">\(n\)</span>个物品,每个物品有两个权值<span class="math inline">\(a_i\)</span>和<span class="math inline">\(b_i\)</span>, 选择任意个物品使得<span class="math inline">\(\frac{\sum a_i}{\sum b_i}\)</span>最大</p>
<h2 id="二分法">二分法</h2>
<p><span class="math display">\[
\frac{\sum_{i = 1}^na_i \cdot w_i}{\sum_{i = 1}^nb_i \cdot w_i} \ge M \Leftrightarrow \sum_{i = 1}^n w_i \cdot (a_i - M\cdot b_i) \ge 0
\]</span></p>
<p>因此只需判断$_{i = 1}^n w_i (a_i - Mb_i) <span class="math inline">\(的最大值是否非负即可对\)</span>M$二分.</p>
<h2 id="dinkelbach-算法迭代法">Dinkelbach 算法(迭代法)</h2>
<p>将上一轮的答案作为输入进行迭代.注意此时答案应为<span class="math inline">\(\frac{\sum_{i = 1}^na_i}{\sum_{i = 1}^nb_i}\)</span>, 而不是变形后的式子.</p>
<h2 id="例题">例题</h2>
<h3 id="poj2728desert-king">[POJ2728]Desert King</h3>
<p>给出<span class="math inline">\(n \leq 10^3\)</span>个点的横纵坐标和高度, 两点间距离为欧几里得距离, 价值为高度之差绝对值. 所有点构成一个完全图. 求一棵生成树使得</p>
<p>距离/价值比最小.</p>
<h4 id="二分法-1">二分法</h4>
<p>此题是有一定限制的0-1分数规划(所选的"物品"构成一棵生成树). 直接求边权为<span class="math inline">\(w_i \cdot (a_i - M\cdot b_i)\)</span>的最小生成树, 判断是否有解即可二分.</p>
<p>由于是完全图, 采用不加优化的Prim求解.</p>
<p>复杂度大概是<span class="math inline">\(O(n^2 \log((R - L)*2^{-eps}))\)</span></p>
<p>由于二分法较慢, 本题需要猜一个答案上界(100)才能通过=-=</p>
<p>用时<code>2610ms</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//POJ2728</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> ld;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e3</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> ld INF = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> ld eps = <span class="number">1e-5</span>;</span><br><span class="line">ld G[maxn][maxn],dis[maxn];</span><br><span class="line"><span class="keyword">int</span> x[maxn],y[maxn],h[maxn],n;</span><br><span class="line">ld w[maxn][maxn];</span><br><span class="line"><span class="keyword">bool</span> vis[maxn];</span><br><span class="line"><span class="function">ld <span class="title">Dis</span><span class="params">(<span class="keyword">int</span> idx1,<span class="keyword">int</span> idx2)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">sqrt</span>((x[idx1] - x[idx2])*(x[idx1] - x[idx2])+(y[idx1] - y[idx2])*(y[idx1] - y[idx2]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">prim</span><span class="params">(ld M)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)vis[i] = <span class="number">0</span>,dis[i] = INF;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)&#123;</span><br><span class="line">		<span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j++)<span class="keyword">if</span>(!vis[j])&#123;</span><br><span class="line">			<span class="keyword">if</span>(!x <span class="keyword">or</span> dis[x] &gt; dis[j])x = j;</span><br><span class="line">		&#125;</span><br><span class="line">		vis[x] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j++)<span class="keyword">if</span>(!vis[j])&#123;</span><br><span class="line">			dis[j] = <span class="built_in">min</span>(dis[j],w[j][x] - M*G[j][x]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	ld tans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)tans += dis[i];</span><br><span class="line">	<span class="keyword">return</span> tans &gt;= <span class="number">0.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n) == <span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(!n)<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;x[i],&amp;y[i],&amp;h[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j++)&#123;</span><br><span class="line">				G[i][j] = <span class="built_in">Dis</span>(i,j);</span><br><span class="line">				w[i][j] = <span class="built_in">abs</span>(h[i] - h[j]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		ld M = <span class="number">0</span>,L = <span class="number">0</span>,R = <span class="number">100</span>;</span><br><span class="line">		<span class="keyword">while</span>(R - L &gt;= eps)&#123;</span><br><span class="line">			M = (L+R)/<span class="number">2</span>;</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">prim</span>(M))L = M;</span><br><span class="line">			<span class="keyword">else</span> R = M;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%.3f\n&quot;</span>,L);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="迭代法">迭代法</h4>
<p>求生成树时仍按边权<span class="math inline">\(w_i \cdot (a_i - M\cdot b_i)\)</span>来计算. 但统计答案则计算<span class="math inline">\(\frac{\sum_{i = 1}^na_i}{\sum_{i = 1}^nb_i}\)</span></p>
<p>跑的飞快(<code>250ms</code>)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//POJ2728</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> ld;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e3</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> ld INF = <span class="number">1e9</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> ld eps = <span class="number">1e-5</span>;</span><br><span class="line">ld G[maxn][maxn],dis[maxn];</span><br><span class="line"><span class="keyword">int</span> x[maxn],y[maxn],h[maxn],to[maxn],n;</span><br><span class="line">ld w[maxn][maxn];</span><br><span class="line"><span class="keyword">bool</span> vis[maxn];</span><br><span class="line"><span class="function">ld <span class="title">Dis</span><span class="params">(<span class="keyword">int</span> idx1,<span class="keyword">int</span> idx2)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">sqrt</span>((x[idx1] - x[idx2])*(x[idx1] - x[idx2])+(y[idx1] - y[idx2])*(y[idx1] - y[idx2]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ld <span class="title">prim</span><span class="params">(ld M)</span></span>&#123;</span><br><span class="line">	ld up = <span class="number">0</span>,down = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i++)vis[i] = <span class="number">0</span>,dis[i] = INF,to[i] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)&#123;</span><br><span class="line">		<span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j++)<span class="keyword">if</span>(!vis[j])&#123;</span><br><span class="line">			<span class="keyword">if</span>(!x <span class="keyword">or</span> dis[x] &gt; dis[j])x = j;</span><br><span class="line">		&#125;</span><br><span class="line">		vis[x] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j++)<span class="keyword">if</span>(!vis[j])&#123;</span><br><span class="line">			<span class="keyword">if</span>(dis[j] &gt; w[x][j] - M*G[x][j])dis[j] = w[x][j] - M*G[x][j],to[j] = x;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i++)&#123;</span><br><span class="line">		up += w[i][to[i]];</span><br><span class="line">		down += G[i][to[i]];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> up/down;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n) == <span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(!n)<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;x[i],&amp;y[i],&amp;h[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j++)&#123;</span><br><span class="line">				G[i][j] = <span class="built_in">Dis</span>(i,j);</span><br><span class="line">				w[i][j] = <span class="built_in">abs</span>(h[i] - h[j]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		ld ans = <span class="number">0</span>,lans = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span>(<span class="built_in">fabs</span>(lans - ans) &gt; eps)&#123;</span><br><span class="line">			lans = ans;</span><br><span class="line">			ans = <span class="built_in">prim</span>(ans);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%.3f\n&quot;</span>,ans);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="多项式">多项式</h1>
<h2 id="fft">FFT</h2>
<p>复数类操作:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">complex&lt;<span class="keyword">double</span>&gt;m;</span><br><span class="line">m.<span class="built_in">real</span>();m.<span class="built_in">imag</span>();<span class="comment">//获取实部虚部的值</span></span><br><span class="line">m.<span class="built_in">real</span>(<span class="number">114</span>);m.<span class="built_in">imag</span>(<span class="number">514</span>);<span class="comment">//为实部虚部赋值</span></span><br></pre></td></tr></table></figure>
<p>包括手写复数类, DFT与IDFT, 多项式乘法.</p>
<ul>
<li><p>复数类: <span class="math inline">\(x\)</span>为实部, <span class="math inline">\(y\)</span>为虚部</p></li>
<li><p><code>FFT(Comp * A,int siz,int type)</code></p>
<p>A: 复数数组, 全局变量, 为待求解的多项式</p>
<p>siz: 多项式长度. 需保证为2的次方</p>
<p>type: 1为DFT, -1为IDFT</p></li>
<li><p><code>Poly mul(Poly A,Poly B)</code></p>
<p>多项式乘法. 输入两个多项式<span class="math inline">\(A,B\)</span>, 长度分别为<span class="math inline">\(n,m\)</span>(也就是<span class="math inline">\(n-1,m-1\)</span>阶). 返回一个长度<span class="math inline">\(n - m + 1\)</span>的多项式, 为<span class="math inline">\(A,B\)</span>的乘积.</p>
<p><code>Poly</code>为<code>vector&lt;int&gt;</code>.</p></li>
</ul>
<p><strong>!!!切记在点值表示法下相乘时, 两个IDFT的长度必须相同!!!</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> ld;</span><br><span class="line"><span class="keyword">typedef</span> vector&lt;<span class="keyword">int</span>&gt; Poly;</span><br><span class="line"><span class="keyword">const</span> ld PI = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"><span class="keyword">int</span> rev[maxn];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Comp</span>&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    <span class="built_in">Comp</span> (<span class="keyword">double</span> x = <span class="number">0</span>, <span class="keyword">double</span> y = <span class="number">0</span>):<span class="built_in">x</span>(x),<span class="built_in">y</span>(y)&#123;&#125;</span><br><span class="line">    Comp <span class="keyword">operator</span> * (Comp B)&#123;</span><br><span class="line">   		<span class="keyword">return</span> <span class="built_in">Comp</span>(x*B.x - y*B.y,x*B.y + y*B.x);</span><br><span class="line">	&#125;</span><br><span class="line">	Comp <span class="keyword">operator</span> + (Comp B)&#123;</span><br><span class="line">	    <span class="keyword">return</span> <span class="built_in">Comp</span>(x + B.x,y + B.y);</span><br><span class="line">	&#125;</span><br><span class="line">	Comp <span class="keyword">operator</span> - (Comp B)&#123;</span><br><span class="line">	    <span class="keyword">return</span> <span class="built_in">Comp</span>(x - B.x,y - B.y);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line">Comp F1[maxn],F2[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(Comp * A,<span class="keyword">int</span> siz,<span class="keyword">int</span> type)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = siz;</span><br><span class="line">	<span class="keyword">int</span> S = <span class="built_in">log2</span>(n);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)rev[i] = (rev[i&gt;&gt;<span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (S - <span class="number">1</span>));</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)<span class="keyword">if</span>(i &lt; rev[i])<span class="built_in">swap</span>(A[i],A[rev[i]]);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i *= <span class="number">2</span>)&#123;</span><br><span class="line">		<span class="function">Comp <span class="title">Wn</span><span class="params">(cos(PI/i),type*sin(PI/i))</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; n;j += i*<span class="number">2</span>)&#123;</span><br><span class="line">			<span class="function">Comp <span class="title">W</span><span class="params">(<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>;k &lt; i;k++)&#123;</span><br><span class="line">				Comp facx = A[j+k],facy = W*A[j+k+i];</span><br><span class="line">				A[j+k] = facx + facy;</span><br><span class="line">				A[j+k+i] = facx - facy;</span><br><span class="line">				W = W*Wn;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">if</span>(type == <span class="number">-1</span>)<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)A[i].x = (<span class="keyword">int</span>)((A[i].x/n + <span class="number">0.5</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Poly <span class="title">mul</span><span class="params">(Poly A,Poly B)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = A.<span class="built_in">size</span>(),m = B.<span class="built_in">size</span>();</span><br><span class="line">	<span class="keyword">int</span> siz = n + m - <span class="number">1</span>;</span><br><span class="line">	<span class="function">Poly <span class="title">C</span><span class="params">(siz)</span></span>;</span><br><span class="line">	<span class="keyword">if</span>(siz &lt; <span class="number">64</span>)&#123;<span class="comment">//小于等于64项直接暴力算</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; m;j++)C[i+j] = (C[i+j] + <span class="number">1LL</span>*A[i]*B[j]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> C;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> fsiz = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(fsiz &lt;= siz)fsiz *= <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; fsiz;i++)F1[i] = F2[i] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)F1[i] = A[i];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++)F2[i] = B[i];</span><br><span class="line">	<span class="built_in">FFT</span>(F1,fsiz,<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">FFT</span>(F2,fsiz,<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; fsiz;i++)F1[i] = F1[i]*F2[i];</span><br><span class="line">	<span class="built_in">FFT</span>(F1,fsiz,<span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; siz;i++)&#123;</span><br><span class="line">		C[i] = ((ll)F1[i].x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> C;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="卷积">卷积</h3>
<p><span class="math display">\[
C[i] = \sum_{j = 0}^i(A[i] - B[j])^2 *A[i]*B[j]*D
\]</span></p>
<p>卷积等同于多项式乘积</p>
<h2 id="ntt">NTT</h2>
<p>从OI-wiki抄来的, 用法和上面的FFT一致. 记得自己手写一遍</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">6e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> p = <span class="number">998244353</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Pow</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> tans = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(d == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">1</span>%p;</span><br><span class="line">	<span class="keyword">int</span> a = <span class="built_in">Pow</span>(x,d/<span class="number">2</span>);</span><br><span class="line">	tans = <span class="number">1ll</span>*a*a%p;</span><br><span class="line">	<span class="keyword">if</span>(d%<span class="number">2</span>)tans = <span class="number">1ll</span>*tans*x%p; </span><br><span class="line">	<span class="keyword">return</span> tans%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> vector&lt;<span class="keyword">int</span>&gt; Poly;</span><br><span class="line"><span class="keyword">int</span> F1[maxn],F2[maxn];</span><br><span class="line"><span class="keyword">int</span> rev[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(<span class="keyword">int</span> * A,<span class="keyword">int</span> lim,<span class="keyword">int</span> opt)</span> </span>&#123;</span><br><span class="line"> 	<span class="keyword">int</span> i, j, k, m, gn, g, tmp;</span><br><span class="line"> 	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; lim; ++i)rev[i] = (i &amp; <span class="number">1</span>)*(lim &gt;&gt; <span class="number">1</span>) + (rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>);</span><br><span class="line"> 	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lim; ++i)<span class="keyword">if</span> (rev[i] &lt; i) <span class="built_in">swap</span>(A[i], A[rev[i]]);</span><br><span class="line"> 	<span class="keyword">for</span>(m = <span class="number">2</span>; m &lt;= lim; m &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">	    k = m &gt;&gt; <span class="number">1</span>;</span><br><span class="line">	    gn = <span class="built_in">Pow</span>(<span class="number">3</span>,(p - <span class="number">1</span>) / m);</span><br><span class="line">	    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lim; i += m) &#123;</span><br><span class="line">	    	g = <span class="number">1</span>;</span><br><span class="line">	    	<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; k; ++j, g = <span class="number">1ll</span> * g * gn % p) &#123;</span><br><span class="line">	    	    tmp = <span class="number">1ll</span> * A[i + j + k] * g % p;</span><br><span class="line">	    	    A[i + j + k] = (A[i + j] - tmp + p) % p;</span><br><span class="line">	     	 	A[i + j] = (A[i + j] + tmp) % p;</span><br><span class="line">	    	&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(opt == <span class="number">-1</span>)&#123;</span><br><span class="line">    	<span class="built_in">reverse</span>(A+<span class="number">1</span>,A+lim);</span><br><span class="line">    	<span class="keyword">int</span> inv = <span class="built_in">Pow</span>(lim,p<span class="number">-2</span>);</span><br><span class="line">    	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lim; ++i) A[i] = <span class="number">1ll</span> * A[i] * inv % p;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Poly <span class="title">mul</span><span class="params">(Poly A,Poly B)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = A.<span class="built_in">size</span>(),m = B.<span class="built_in">size</span>();</span><br><span class="line">	<span class="keyword">int</span> siz = n + m - <span class="number">1</span>;</span><br><span class="line">	<span class="function">Poly <span class="title">C</span><span class="params">(siz)</span></span>;</span><br><span class="line">	<span class="keyword">if</span>(siz &lt; <span class="number">64</span>)&#123;<span class="comment">//小于等于64项直接暴力算</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; m;j++)C[i+j] = (C[i+j] + <span class="number">1LL</span>*A[i]*B[j]%p)%p;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> C;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> fsiz = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(fsiz &lt;= siz)fsiz *= <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; fsiz;i++)F1[i] = F2[i] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)F1[i] = A[i];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; m;i++)F2[i] = B[i];</span><br><span class="line">	<span class="built_in">NTT</span>(F1,fsiz,<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">NTT</span>(F2,fsiz,<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; fsiz;i++)F1[i] = <span class="number">1ll</span>*F1[i]*F2[i]%p;</span><br><span class="line">	<span class="built_in">NTT</span>(F1,fsiz,<span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; siz;i++)&#123;</span><br><span class="line">		C[i] = F1[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> C;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>与FFT的区别在点值表示法相乘时, NTT需要取模. 另外注意原根需与模数对应</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; (<span class="keyword">int</span>)A.<span class="built_in">size</span>();i++)A[i] = <span class="number">1ll</span>*A[i]*B[i]%p;</span><br></pre></td></tr></table></figure>
<h2 id="求逆">求逆</h2>
<p>板子来源: <a target="_blank" rel="noopener" href="https://blog.orzsiyuan.com/archives/Polynomial-Inversion/">Siyuan -「算法笔记」多项式求逆</a></p>
<p>调用<code>invP(Poly A)</code>,返回模<span class="math inline">\(x^n\)</span>意义下<span class="math inline">\(A\)</span>的逆. 其中<span class="math inline">\(A\)</span>是一个<span class="math inline">\(n-1\)</span>次多项式(实际上是一个长度为<span class="math inline">\(n\)</span>的<code>vector&lt;int&gt;</code>)</p>
<p>时间复杂度: <span class="math inline">\(O(nlogn)\)</span></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> P[maxn],Q[maxn];</span><br><span class="line"><span class="function">Poly <span class="title">invP</span><span class="params">(Poly A)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = A.<span class="built_in">size</span>();</span><br><span class="line">	<span class="keyword">int</span> siz = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(siz &lt; n)siz *= <span class="number">2</span>;</span><br><span class="line">	A.<span class="built_in">resize</span>(siz);</span><br><span class="line">	<span class="function">Poly <span class="title">I</span><span class="params">(siz)</span></span>;</span><br><span class="line">	I[<span class="number">0</span>] = <span class="built_in">Pow</span>(A[<span class="number">0</span>],p<span class="number">-2</span>);<span class="comment">//inv(A[0]);</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> h = <span class="number">2</span>;h &lt;= siz;h *= <span class="number">2</span>)&#123;</span><br><span class="line">		<span class="keyword">int</span> H = h*<span class="number">2</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= H;i++)P[i] = Q[i] = <span class="number">0</span>;<span class="comment">//重要,必须清空</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; h;i++)P[i] = A[i],Q[i] = I[i];</span><br><span class="line">		<span class="built_in">NTT</span>(P,H,<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">NTT</span>(Q,H,<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; H;i++)&#123;</span><br><span class="line">			P[i] = <span class="number">1ll</span>*Q[i]*(<span class="number">2</span> - <span class="number">1ll</span>*P[i]*Q[i]%p + p)%p;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">NTT</span>(P,H,<span class="number">-1</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; h;i++)I[i] = P[i];</span><br><span class="line">	&#125;</span><br><span class="line">	I.<span class="built_in">resize</span>(n);</span><br><span class="line">	<span class="keyword">return</span> I;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="求导-积分">求导, 积分</h2>
<p>derP求导, intP积分, 复杂度均为<span class="math inline">\(O(n)\)</span>. 其中积分需要先预处理逆元<code>inv[]</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Poly <span class="title">derP</span><span class="params">(Poly A,<span class="keyword">bool</span> samelen = <span class="number">1</span>)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = A.<span class="built_in">size</span>();</span><br><span class="line">	<span class="function">Poly <span class="title">D</span><span class="params">(n<span class="number">-1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)D[i<span class="number">-1</span>] = <span class="number">1ll</span>*i*A[i]%p;</span><br><span class="line">	<span class="keyword">if</span>(samelen)D.<span class="built_in">resize</span>(n);</span><br><span class="line">	<span class="keyword">return</span> D;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Poly <span class="title">intP</span><span class="params">(Poly A,<span class="keyword">bool</span> samelen = <span class="number">1</span>)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = A.<span class="built_in">size</span>();</span><br><span class="line">	<span class="function">Poly <span class="title">ans</span><span class="params">(n+<span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i++)ans[i] = <span class="number">1ll</span>*inv[i]*A[i<span class="number">-1</span>]%p;</span><br><span class="line">	<span class="keyword">if</span>(samelen)ans.<span class="built_in">resize</span>(n);</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="取对数">取对数</h2>
<p>输入<span class="math inline">\(A(x)\)</span>, 求<span class="math inline">\(B(x) \equiv ln(A(x)) \pmod {x^n}\)</span>. 两边同时求导得: <span class="math display">\[
B&#39;(x) = \frac{A&#39;(x)}{A(x)}\text dx
\]</span> 再积分: <span class="math display">\[
B(x) = ln(A(x)) = \int B&#39;(x)\text dx = \int\frac{A&#39;(x)}{A(x)}\text dx
\]</span> 需要求逆,求导和积分, 需保证<span class="math inline">\(A[0] = 1\)</span>. 复杂度<span class="math inline">\(O(n\log n)\)</span></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Poly <span class="title">lnP</span><span class="params">(Poly A)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">intP</span>(<span class="built_in">mul</span>(<span class="built_in">derP</span>(A),<span class="built_in">invP</span>(A)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="指数函数">指数函数</h2>
<p><strong>常数过大，需要优化</strong></p>
<p>和求逆基本相同, 返回<span class="math inline">\(e^{A(x)}\)</span>. 复杂度<span class="math inline">\(O(nlogn)\)</span></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Poly <span class="title">expP</span><span class="params">(Poly A)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = A.<span class="built_in">size</span>();</span><br><span class="line">	<span class="keyword">int</span> siz = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(siz &lt; n)siz *= <span class="number">2</span>;</span><br><span class="line">	A.<span class="built_in">resize</span>(siz);</span><br><span class="line">	<span class="function">Poly <span class="title">E</span><span class="params">(siz)</span></span>;</span><br><span class="line">	E[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> h = <span class="number">2</span>;h &lt;= siz;h *= <span class="number">2</span>)&#123;</span><br><span class="line">		<span class="function">Poly <span class="title">B</span><span class="params">(h)</span>,<span class="title">C</span><span class="params">(h)</span></span>;;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; h;i++)B[i] = C[i] = E[i];</span><br><span class="line">		B = <span class="built_in">lnP</span>(B);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; h;i++)B[i] = (<span class="number">1ll</span>*-B[i] + A[i] + <span class="number">2ll</span>*p)%p;</span><br><span class="line">		B[<span class="number">0</span>] = (B[<span class="number">0</span>] + <span class="number">1</span>)%p;</span><br><span class="line">		B = <span class="built_in">mul</span>(B,C);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; h;i++)E[i] = B[i];</span><br><span class="line">	&#125;</span><br><span class="line">	E.<span class="built_in">resize</span>(n);</span><br><span class="line">	<span class="keyword">return</span> E;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="快速幂">快速幂</h2>
<p>求<span class="math inline">\(A(x)^k\)</span>, 显然有<span class="math inline">\(A(x)^k = e^{k\cdot ln(A(x))}\)</span></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//需保证A[0] == 1</span></span><br><span class="line"><span class="function">Poly <span class="title">powP</span><span class="params">(Poly A,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = A.<span class="built_in">size</span>(),x = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(x &lt; n <span class="keyword">and</span> A[x] == <span class="number">0</span>)x++;</span><br><span class="line">	<span class="keyword">if</span>(<span class="number">1ll</span>*x*k &gt;= n)<span class="keyword">return</span> <span class="built_in">Poly</span>(n,<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">int</span> v = A[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">int</span> vk = <span class="built_in">Pow</span>(v,k);</span><br><span class="line">	A = <span class="built_in">lnP</span>(A);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)A[i] = <span class="number">1ll</span>*A[i]*k%p;</span><br><span class="line">	Poly B = <span class="built_in">expP</span>(A);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)A[i] = <span class="number">1ll</span>*A[i]*vk%p;</span><br><span class="line">	<span class="keyword">return</span> B;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Poly <span class="title">powP</span><span class="params">(Poly A,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = A.<span class="built_in">size</span>(),x = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(x &lt; n <span class="keyword">and</span> A[x] == <span class="number">0</span>)x++;</span><br><span class="line">	<span class="keyword">if</span>(<span class="number">1ll</span>*x*k &gt;= n)<span class="keyword">return</span> <span class="built_in">Poly</span>(n,<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">if</span>(x)&#123;</span><br><span class="line">		<span class="function">Poly <span class="title">B</span><span class="params">(n)</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = x;i &lt; n;i++)B[i-x] = A[i];</span><br><span class="line">		A = B;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> v = A[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">int</span> vk = <span class="built_in">Pow</span>(v,k);</span><br><span class="line">	A = <span class="built_in">lnP</span>(A);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)A[i] = <span class="number">1ll</span>*A[i]*k%p;</span><br><span class="line">	Poly B = <span class="built_in">expP</span>(A);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)A[i] = <span class="number">1ll</span>*A[i]*vk%p;</span><br><span class="line">	<span class="keyword">if</span>(x)&#123;</span><br><span class="line">		<span class="keyword">int</span> xk = <span class="number">1ll</span>*x*k%p;</span><br><span class="line">		<span class="function">Poly <span class="title">B</span><span class="params">(n)</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n - xk;i++)B[i+xk] = A[i];</span><br><span class="line">		A = B;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> B;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="高阶差分前缀和">高阶差分/前缀和</h2>
<p>求<span class="math inline">\(A[]\)</span>的<span class="math inline">\(k\)</span>阶差分/前缀和. 设<span class="math inline">\(A\)</span>的OGF: <span class="math inline">\(F(x) = \sum_{i = 0}^{\infin}A_ix^i\)</span></p>
<p>显然前缀和是<span class="math inline">\(F(x)\cdot\sum_{i=0}^{\infin}x^i = F(x)\cdot \frac{1}{1-x}\)</span>, 差分是<span class="math inline">\(F(x)\cdot(1-x)\)</span></p>
<p>那么<span class="math inline">\(k\)</span>阶前缀和是<span class="math inline">\(F(x)\cdot (\frac{1}{1-x})^k\)</span>, 差分是<span class="math inline">\(F(x)\cdot(1-x)^k\)</span>. 复杂度为<span class="math inline">\(O(nlogk)\)</span>, 但常数巨大且很不好写.</p>
<p>另有结论:</p>
<p>前缀和<span class="math inline">\(F(x)\cdot\sum_{i = 0}^nC_{k+i-1}^ix^i\)</span></p>
<p>差分<span class="math inline">\(F(x)\cdot\sum_{i=0}^n(-1)^iC_n^ix^i\)</span></p>
<p>复杂度<span class="math inline">\(O(n\log n)\)</span>. 使用前先预处理逆元.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Poly <span class="title">presumP</span><span class="params">(Poly A,ll k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = A.<span class="built_in">size</span>();</span><br><span class="line">	<span class="function">Poly <span class="title">G</span><span class="params">(n)</span></span>;</span><br><span class="line">	G[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)G[i] = G[i<span class="number">-1</span>]*(k+i<span class="number">-1</span>)%p*inv[i]%p;</span><br><span class="line">	A = <span class="built_in">mul</span>(A,G);</span><br><span class="line">	<span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Poly <span class="title">diffP</span><span class="params">(Poly A,ll k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = A.<span class="built_in">size</span>();</span><br><span class="line">	<span class="function">Poly <span class="title">G</span><span class="params">(n)</span></span>;</span><br><span class="line">	G[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; n;i++)G[i] = (G[i<span class="number">-1</span>]*(<span class="number">-1</span>) + p)%p*(k-i+<span class="number">1</span>)%p*inv[i]%p;	</span><br><span class="line">	A = <span class="built_in">mul</span>(A,G);</span><br><span class="line">	<span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="组合数学">组合数学</h1>
<h2 id="杂乱的结论">杂乱的结论</h2>
<h3 id="长度为n-可选1m的本质不同序列个数">长度为n, 可选[1,m]的本质不同序列个数</h3>
<p>(本质不同即将序列排序后两个序列不相同) <span class="math display">\[
C_{n+m-1}^{m-1}
\]</span></p>
<h3 id="递推组合数">递推组合数</h3>
<p><span class="math display">\[
C_n^0 = 1\\
C_n^i = C_n^{i-1}\cdot \frac{n-i+1}{i}\\
C_{n+i-1}^i = C_{n+i-2}^{i-1}\cdot \frac{n+i-1}{i}
\]</span></p>
<h1 id="生成函数">生成函数</h1>
<h2 id="ogf">OGF</h2>
<h3 id="常用公式">常用公式</h3>
<ul>
<li>Part1</li>
</ul>
<p><span class="math display">\[
\sum_{i=0}^nx^i = \frac{1-x^{n+1}}{1-x} (等比数列求和)\\
\sum_{i=0}^\infin x^i = \frac{1}{1-x}\\
\sum_{i = 0}^\infin x^{c\cdot i} = \frac{1}{1 - x^c}
\]</span></p>
<ul>
<li>Part2 <span class="math display">\[
  \frac{1}{(1-x)^n} = \sum_{i = 0}^\infin C_{n+i-1}^{i-1}x^i\\
  \frac{1}{(1-x)^{n+1}} = \sum_{i = 0}^\infin C_{n+i}^i x^i
  \]</span></li>
</ul>
<h1 id="杂项">杂项</h1>
<h2 id="杂乱的知识点">杂乱的知识点</h2>
<ul>
<li><p><span class="math display">\[
  \lfloor \frac{a}{bc} \rfloor = \lfloor \frac{\lfloor \frac{a}{b} \rfloor}{c} \rfloor
  \]</span></p></li>
<li><p><span class="math display">\[
  a +b = a\oplus b + 2\cdot a \&amp;b
  \]</span></p></li>
<li><p>设<span class="math inline">\(c(n)\)</span>为第<span class="math inline">\(n\)</span>个Catalan数, 则有<span class="math inline">\(\sum_{k = 0}^{n-1}c(k)\cdot c(n-1-k) = c(n)\)</span></p></li>
<li><p>区间加平方和(范围<span class="math inline">\([l,n]\)</span>)可通过差分进行. 设差分数组为<span class="math inline">\(d\)</span>, 每次对<span class="math inline">\([l,n]\)</span>加平方和的操作转换为<code>d[l]++,d[l+1]++</code>, 然后求d的3阶前缀和即可单点查询.</p></li>
</ul>
<h2 id="图兰定理">图兰定理</h2>
<p>对于一个有 <span class="math inline">\(n\)</span>个点的无向图，若其中不存在三个点的环，则边数不超过 <span class="math inline">\(n^2/4\)</span></p>
<h2 id="pick定理">Pick定理</h2>
<p>给定一个顶点均为整点(坐标为整数的点)的简单多边形,其面积<span class="math inline">\(A\)</span>和内部格点数<span class="math inline">\(I\)</span>,边上格点数<span class="math inline">\(B\)</span>的关系是: <span class="math inline">\(A = I+B/2 - 1\)</span></p>
<h2 id="cayley公式">Cayley公式</h2>
<p>一个有<span class="math inline">\(n\)</span>个节点的完全图有<span class="math inline">\(n^{n-2}\)</span>种不同的生成树</p>
<h2 id="polya定理1">Polya定理1</h2>
<pre><code>-仅旋转,染色数和顶点数均为n.欧拉函数优化(抄自Lskkkno1的题解qwq)</code></pre>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">polya</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">	ll tans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i*i &lt;= n;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n%i)<span class="keyword">continue</span>;</span><br><span class="line">		tans += (<span class="built_in">cal_phi</span>(n/i)*<span class="built_in">pow_mod</span>(n,i<span class="number">-1</span>))%MOD;</span><br><span class="line">		<span class="keyword">if</span>(i*i != n)tans += <span class="built_in">cal_phi</span>(i)*<span class="built_in">pow_mod</span>(n,n/i<span class="number">-1</span>)%MOD;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> tans%MOD;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><span class="math display">\[
C_k^k +C_{k+1}^k +...+C_{n}^k（n &gt; k)
\]</span></p>
<h2 id="某些数列">某些数列</h2>
<p>对于数列<span class="math inline">\(\{1,2,2,3,3,3,4,4,4,4,...\}\)</span>(数<span class="math inline">\(i\)</span>出现了<span class="math inline">\(i\)</span>)次, 有通项公式 <span class="math display">\[
a_n = \frac{1+2\sqrt{2n}}{2}
\]</span></p>
<p><span class="math display">\[
\sum_{i = 1}^\infin i \cdot \frac{1}{a^i}
\]</span></p>
<p>海伦公式</p>
<p><span class="math inline">\(a,b,c\)</span>为三角形边长, <span class="math inline">\(s = \frac{a+b+c}{2}\)</span></p>
<p>三角形面积为<span class="math inline">\(S = \sqrt{s(s-a)(s-b)(s-c)}\)</span></p>
<h2 id="组合数奇偶性">组合数奇偶性</h2>
<p>对于<span class="math inline">\(C_n^k\)</span>, 如果<span class="math inline">\(n\&amp;k == k\)</span>为奇数, 否则偶数.(按位and)</p>
<h2 id="生成2进制恰好包含k位的下一个数">生成2进制恰好包含k位的下一个数</h2>
<p>若<span class="math inline">\(x\)</span>里有<span class="math inline">\(k\)</span>个1, 则<code>gen_next(x)</code>为包含<span class="math inline">\(k\)</span>个1的下一位数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gen_next</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> b = x &amp; -x;</span><br><span class="line">	<span class="keyword">int</span> t = x + b;</span><br><span class="line">	<span class="keyword">int</span> c = t &amp; -t;</span><br><span class="line">	<span class="keyword">int</span> m = (c/b &gt;&gt; <span class="number">1</span>) - <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> t | m;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="求区间nm内不含平方因子的数">求区间[n,m]内不含平方因子的数</h2>
<p>筛掉<span class="math inline">\(p^2\)</span>即可. <span class="math inline">\(p\)</span>是素数且<span class="math inline">\(p \in [n,m]\)</span></p>
<h2 id="等比数列">等比数列</h2>
<p><span class="math inline">\(a\)</span>为首项, <span class="math inline">\(q\)</span>为公比</p>
<h3 id="求和">求和</h3>
<p><span class="math display">\[
S_n = a \cdot \frac{1-q^n}{1-q} (q \ne 1)
\]</span></p>
<h3 id="求积">求积</h3>
<p><span class="math display">\[
P_n = a^n \cdot q^{\frac{n(n-1)}{2}}
\]</span></p>
<h2 id="子集">子集</h2>
<p>对于集合<span class="math inline">\(S = \{a_i\}，i = 1...n\)</span></p>
<p>其全部子集中元素和的和为</p>
<p><span class="math inline">\(2^{n-1}\cdot \sum_{i = 1}^na_i\)</span></p>
<p>其全部子集中元素积的和为</p>
<p><span class="math inline">\(\prod_{i = 1}^n(a_i + 1)\)</span></p>
<h3 id="枚举子集">枚举子集</h3>
<ol type="1">
<li><p>给定集合<span class="math inline">\(m\)</span>, 枚举它的全部子集:</p>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> S = m;S &gt;= <span class="number">0</span>;S = (S<span class="number">-1</span>)&amp;m)</span><br></pre></td></tr></table></figure></p></li>
<li><p>枚举大小为<span class="math inline">\(n\)</span>的全部集合<span class="math inline">\(m\)</span>, 且对于每个<span class="math inline">\(m\)</span>, 枚举其全部子集<span class="math inline">\(S\)</span>. 时间复杂度<span class="math inline">\(O(3^n)\)</span>:</p>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> m = <span class="number">0</span>;m &lt; (<span class="number">1</span>&lt;&lt;n);m++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> S = m;S &gt;= <span class="number">0</span>; S = (S<span class="number">-1</span>)&amp;m)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p></li>
</ol>
<h3 id="子集和高维前缀和">子集和/高维前缀和</h3>
<p>求解如下问题:</p>
<p>子集和: <span class="math display">\[
f[S] = \sum_{T \in S}f[T]
\]</span> 超集和: <span class="math display">\[
f[T] = \sum_{T\in S}f[S]
\]</span></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="number">1</span> &lt;&lt; n); j++)</span><br><span class="line">        <span class="keyword">if</span>(j &amp; (<span class="number">1</span> &lt;&lt; i))&#123;</span><br><span class="line">            f[j] += f[j ^ (<span class="number">1</span> &lt;&lt; i)];</span><br><span class="line">			<span class="comment">//或f[j ^ (1 &lt;&lt; i)] += f[j];</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>时间复杂度<span class="math inline">\(O(n \cdot 2^n)\)</span> <span class="math display">\[
\begin{align}
x &amp;= a +b+c+d\\\\
 &amp;= e +f\\\\
 &amp;= g
\end{align}
\]</span></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%A8%A1%E6%9D%BF/" rel="tag"># 模板</a>
              <a href="/tags/math/" rel="tag"># math</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
            </div>
            <div class="post-nav-item">
                <a href="/2020/05/09/template-data-structure/" rel="next" title="">
                   <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">LinkinPony</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","cdn":"//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
